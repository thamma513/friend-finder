<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>FriendFinder</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">

</head>

<body>
    <div class="container">


            <h2>Survey Questions</h2>
            <hr>

            <h3>
                <strong>About You</strong>
            </h3>
            <h4>Name (Required)</h4>
            <input type="text" id="name" class="form-control" required>

            <h4>Link to Photo Image (Required)</h4>
            <input type="text" id="photo" class="form-control" required>

            <hr>

            <h3>
                <strong>Question 1</strong>
            </h3>
            <h4>You love getting outside into nature.</h4>
            <select class="chosen-select" id="q1">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>

            <h3>
                <strong>Question 2</strong>
            </h3>
            <h4>You are the life of the party.</h4>
            <select class="chosen-select" id="q2">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>


            <h3>
                <strong>Question 3</strong>
            </h3>
            <h4>You would rather stay in and watch movies or listen to music rather than go out to a bar.</h4>
            <select class="chosen-select" id="q3">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>


            <h3>
                <strong>Question 4</strong>
            </h3>
            <h4>You can lose hours worth of time tinkering with things.</h4>
            <select class="chosen-select" id="q4">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>


            <h3>
                <strong>Question 5</strong>
            </h3>
            <h4>Change does not come easy for you.</h4>
            <select class="chosen-select" id="q5">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>


            <h3>
                <strong>Question 6</strong>
            </h3>
            <h4>People often ask you for advice.</h4>
            <select class="chosen-select" id="q6">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>


            <h3>
                <strong>Question 7</strong>
            </h3>
            <h4>It is easy for you to see things from another's perspective.</h4>
            <select class="chosen-select" id="q7">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>

            <h3>
                <strong>Question 8</strong>
            </h3>
            <h4>You strive to take on challenges.</h4>
            <select class="chosen-select" id="q8">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>

            <h3>
                <strong>Question 9</strong>
            </h3>
            <h4>You strive to reach the top in any situaiton.</h4>
            <select class="chosen-select" id="q9">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>

            <h3>
                <strong>Question 10</strong>
            </h3>
            <h4>You are a Jack of all trades, and a master of none.</h4>
            <select class="chosen-select" id="q10">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>

            <br>
            <br>
            <button type="submit" class="btn btn-primary btn-lg">Submit</button>
    <br>
    <br>
    <div id="match"></div>

<script src="https://code.jquery.com/jquery.js"></script>
<script type= "text/javascript">

    $(".btn").on("click", function(event){
    event.preventDefault();
    

        var newFriend = {
        "name": $("#name").val().trim(),
        "photo": $("#photo").val().trim(),
        "scores": [$("#q1").val().trim(), $("#q2").val().trim(), $("#q3").val().trim(), $("#q4").val().trim(), $("#q5").val().trim(),
         $("#q6").val().trim(), $("#q7").val().trim(), $("#q8").val().trim(), $("#q9").val().trim(), $("#q10")]
    }
    work(newFriend);


    $.post("api/friends", newFriend).then( function(data){
        console.log("New respose posted")
    });
    
    $("#name").val("");
    $("#photo").val("");
    $("#q1").val("");
    $("#q2").val("");
    $("#q3").val("");
    $("#q4").val("");
    $("#q5").val("");
    $("#q6").val("");
    $("#q7").val("");
    $("#q8").val("");
    $("#q9").val("");
    $("#q10").val("");
    });
    function work(newFriend){
        var newAnswers = newFriend.answers;
        var currentURL = window.location.origin;
    
        $.ajax({
            url: currentURL + "/api/friends",
            method: "GET"
        }).then(function(res){
            console.log(res);
            var scores = [];
            for(var i = 0; i < res.length; i++){
                var answers = res[i].answers;
                var difference = 0
                
                for(var x = 0; x < 5; x++){
                    difference += Math.abs(newAnswers[x] - answers[x]);
                }
                scores.push(difference);
            }
            var indexMatch = scores.indexOf(Math.min(...scores));
            console.log(res[indexMatch].name);
            $("#match").append("<h2>Your Best Match: " + res[indexMatch].name + "!!!</h2>");
            alert("Your best match is " + res[indexMatch].name);
        });
    }
</script>
</body>
</html>